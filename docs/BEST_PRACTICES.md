# 使用最佳实践

## 编写高质量Prompt的技巧

为了获得最佳的代码生成效果，请遵循以下建议：

### ✅ 推荐的Prompt写法

#### 1. 简洁明确
```json
{
  "prompt": "创建一个Go语言的TODO API，包含增删改查功能",
  "repo_name": "go-todo-api"
}
```

#### 2. 指定核心功能
```json
{
  "prompt": "创建一个Python Flask应用：1) 用户注册登录 2) JWT认证 3) 用户信息CRUD API",
  "repo_name": "flask-auth-api"
}
```

#### 3. 明确技术栈
```json
{
  "prompt": "使用React + TypeScript创建一个计数器应用，包含Redux状态管理",
  "repo_name": "react-counter"
}
```

### ❌ 避免的Prompt写法

#### 1. 过于复杂
```json
{
  "prompt": "创建一个完整的电商系统，包含用户管理、商品管理、订单管理、支付系统、物流追踪、评论系统、推荐算法、数据分析后台...",
  "repo_name": "complex-ecommerce"
}
```
**问题**: 项目太复杂，可能导致生成的代码不完整或超出token限制。

#### 2. 缺乏具体信息
```json
{
  "prompt": "写一个网站",
  "repo_name": "website"
}
```
**问题**: 描述太模糊，生成的代码可能不符合预期。

#### 3. 要求过多细节
```json
{
  "prompt": "创建一个博客系统，要有登录注册，每个用户可以发布文章，文章要支持Markdown，要有评论功能，评论要支持点赞，要有标签系统，要有搜索功能，要有分类，要有归档页面，要有RSS订阅...",
  "repo_name": "blog-system"
}
```
**问题**: 功能太多，可能导致响应被截断。

## Token限制说明

### 当前限制
- **DeepSeek**: 最大8000 tokens输出
- **OpenAI**: 最大8000 tokens输出

### 如何避免超出限制

1. **限制文件数量**: 建议生成3-5个核心文件
2. **简化需求**: 只描述核心功能，避免列举所有细节
3. **分步骤**: 如果需要复杂项目，可以先生成基础版本，然后手动扩展

## 常见问题和解决方案

### 问题1: JSON解析错误

**错误信息**: `unexpected end of JSON input`

**原因**: LLM生成的内容超过token限制被截断

**解决方案**:
1. 简化prompt，减少功能描述
2. 使用更具体但更简洁的描述
3. 只要求核心功能

### 问题2: 生成的代码不完整

**原因**: Prompt过于复杂

**解决方案**:
1. 将大项目拆分成小模块
2. 每次只生成一个模块
3. 使用"创建一个简单的..."作为前缀

### 问问题3: 生成的代码不符合预期

**原因**: Prompt描述不够明确

**解决方案**:
1. 明确指定编程语言和框架
2. 列出2-3个核心功能
3. 给出具体的使用场景

### 问题4: GitHub仓库创建失败 (404错误)

**错误信息**: `404 Not Found` 或 `organization or user not found`

**原因**: 
1. `GITHUB_OWNER` 配置的组织或用户不存在
2. 你不是该组织的成员
3. Token没有在该组织下创建仓库的权限

**解决方案**:

1. **验证组织存在**:
   ```bash
   # 访问 https://github.com/your-org-name
   # 确认组织存在且你是成员
   ```

2. **检查Token权限**:
   - 访问: https://github.com/settings/tokens
   - 确保勾选: `repo` (必选)
   - 如果是组织: 还需要 `admin:org` 权限

3. **最简单的解决方案**:
   ```bash
   # 删除或注释掉 GITHUB_OWNER，这样会在你的个人账户下创建仓库
   # GITHUB_OWNER=my-org  # 注释掉这行
   ```

4. **如果确实需要在组织下创建**:
   - 联系组织管理员添加你为成员
   - 给予你创建仓库的权限
   - 重新生成Token并勾选正确的权限

## Prompt模板

### Go项目
```
创建一个Go语言的[项目类型]，实现[核心功能1]、[核心功能2]和[核心功能3]
```

**示例**:
```
创建一个Go语言的HTTP服务器，实现健康检查、用户认证和日志记录
```

### Python项目
```
创建一个Python [框架名]应用，包含[功能1]和[功能2]
```

**示例**:
```
创建一个Python Flask应用，包含用户注册登录和简单的博客API
```

### JavaScript/TypeScript项目
```
使用[框架名]创建一个[应用类型]，实现[核心功能]
```

**示例**:
```
使用React创建一个待办事项应用，实现任务的增删改查
```

### 通用项目
```
创建一个[语言]的[项目类型]，包含以下功能：
1. [功能1]
2. [功能2]
3. [功能3]
```

## 优化建议

### 1. 使用分层描述

✅ **好的方式**:
```
创建一个Go微服务：
- 核心: RESTful API
- 功能: 用户CRUD
- 技术: Gin框架 + SQLite
```

❌ **避免**:
```
创建一个完整的微服务架构，包含API网关、服务发现、配置中心...（省略100字）
```

### 2. 明确项目规模

使用"简单的"、"基础的"、"演示"等词语：

```
创建一个简单的Python数据分析工具，读取CSV并生成图表
```

### 3. 提供参考

```
创建一个类似于GitHub的issues页面，使用React实现基本的列表和筛选功能
```

## 成功案例

### 案例1: Go REST API
```json
{
  "prompt": "创建一个Go语言的书籍管理API，支持增删改查，使用Gin框架和内存存储",
  "repo_name": "go-book-api"
}
```
**结果**: ✅ 生成成功，代码完整可运行

### 案例2: Python CLI工具
```json
{
  "prompt": "创建一个Python命令行工具，用于文件批量重命名，支持正则表达式匹配",
  "repo_name": "py-file-renamer"
}
```
**结果**: ✅ 生成成功，功能完整

### 案例3: JavaScript组件
```json
{
  "prompt": "创建一个Vue.js的日历组件，支持日期选择和事件标记",
  "repo_name": "vue-calendar"
}
```
**结果**: ✅ 生成成功，组件可用

## 调试技巧

### 1. 查看错误信息
通过SSE可以实时看到详细的错误信息，包括：
- LLM响应预览
- JSON解析错误位置
- 建议的改进方案

### 2. 逐步简化
如果遇到错误，尝试：
1. 减少功能数量
2. 简化描述语言
3. 使用更通用的技术栈

### 3. 参考示例
查看项目中的 `test.sh` 和 `test.html` 中的示例prompt

## 技术限制

### 文件限制
- 建议生成 **3-5个文件**
- README.md应该 **简洁明了**（200-500行代码总量）
- 每个代码文件 **控制在200行以内**

### 内容限制
- 避免生成大量重复代码
- 避免生成长篇文档
- 专注于核心逻辑实现

### 语言支持
优先支持：
- ✅ Go, Python, JavaScript/TypeScript
- ✅ Markdown, JSON, YAML
- ⚠️ 其他语言可能需要更详细的说明

## 总结

**核心原则**:
1. 🎯 **简洁明确**: 清楚地说明要做什么
2. 📏 **控制规模**: 保持项目小而美
3. 🔍 **具体细节**: 指定技术栈和核心功能
4. ⚡ **快速迭代**: 先生成基础版本，再手动扩展

遵循这些最佳实践，你将获得更好的代码生成体验！🚀
